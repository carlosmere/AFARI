@model VEH.Intranet.ViewModel.User.AddEditUsuarioViewModel

@{
    ViewBag.Title = (Model.UsuarioId != null ? "Editar" : "Agregar") + " usuario";
}

@section Breadcrumbs{
    <li><a href="@Url.Action("LstUsuarioAdm", "User")">Usuario</a></li>
}

@section Styles{
    @RazorHelpers.Content("plugins/password-indicator/css/password-indicator.css", Url)
}

@section Scripts{
    @RazorHelpers.Content("plugins/password-indicator/js/password-indicator.js", Url)

    <script type="text/javascript">
        $(document).ready(function () {

            var handleFormPasswordIndicator = function () {
                "use strict";
                $("#password-indicator-visible").passwordStrength({ targetDiv: "#passwordStrengthDiv2" })
            };
            var FormPlugins = function () { "use strict"; return { init: function () { handleFormPasswordIndicator(); } } }()
            FormPlugins.init();

            $("#Codigo").change(function (e) {
                e.preventDefault()
                $.ajax({
                    cache: false,
                    type: "GET",
                    url: "@Url.Action("VerificarCodigoUsuario")",
                    data: { "codigo": this.value },
                    success: function (data) {
                        $("#spUsuarioExiste").empty().html("")
                        if (!data) { $("#spUsuarioExiste").html('<i class="fa fa-times"></i> <span style="color:#e5603b"> El código de usuario ya existe</span>') }
                        else { $("#spUsuarioExiste").html('<i style="color:#7cdda7" class="fa fa-check"></i> <span ></span>') }
                        //else { $("#spUsuarioExiste").html('<i class="fa fa-check"></i> <span style="color:#7cdda7"> El código de usuario esta disponible</span>') }
                    }
                })
            })
        })
    </script>
}
<div class="panel panel-inverse">
    <div class="panel-body">
        <form method="post" class="form-horizontal" enctype="multipart/form-data">
            @Html.HiddenFor(x => x.UsuarioId)
            @Html.HiddenFor(x => x.EdificioId)
            @Html.HiddenFor(x => x.DepartamentoId)
            <div class="form-group">
                <label class="col-md-2 control-label">Usuario</label>
                <div class="col-md-3">
                    @Html.TextBoxFor(x => x.Codigo, new { @class = "form-control " })
                    <span id="spUsuarioExiste"> </span>
                    @Html.ValidationMessageFor(x => x.Codigo)
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">Nombres</label>
                <div class="col-md-3">
                    @Html.TextBoxFor(x => x.Nombres, new { @class = "form-control " })
                    <span id="spUsuarioExiste"> </span>
                    @Html.ValidationMessageFor(x => x.Nombres)
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">Apellidos</label>
                <div class="col-md-3">
                    @Html.TextBoxFor(x => x.Apellidos, new { @class = "form-control " })
                    <span id="spUsuarioExiste"> </span>
                    @Html.ValidationMessageFor(x => x.Apellidos)
                </div>
            </div>
            <input type="hidden" name="Estado" value="ACT" />


            <div class="form-group">
                <label class="col-md-2 control-label">Contraseña</label>
                <div class="col-md-4">
                    @Html.TextBoxFor(x => x.Password, new { @class = "form-control  m-b-5", name = "password-visible", id = "password-indicator-visible" })
                    <div id="passwordStrengthDiv2" class="is0 m-t-5"></div>
                    @Html.ValidationMessageFor(x => x.Password)
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">Email</label>
                <div class="col-md-6">
                    @Html.TextBoxFor(x => x.Email, new { @class = "form-control" })
                    @Html.ValidationMessageFor(x => x.Email)
                </div>
            </div>

            <div class="form-group">
                <label class="col-md-2 control-label">Nombre Remitente (Correo)</label>
                <div class="col-md-6">
                    @Html.TextBoxFor(x => x.NombreEncargado, new { @class = "form-control" })
                    @Html.ValidationMessageFor(x => x.NombreEncargado)
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">Firma</label>
                <div class="col-md-6">
                    @Html.TextBoxFor(x => x.Firma, new { @class = "form-control", type = "file" })
                    @Html.ValidationMessageFor(x => x.Firma)
                    @if (!string.IsNullOrEmpty(Model.RutaFirma))
                    {
                        <a target="_blank" href="@Url.Content("~/Resources/Files/")@Model.RutaFirma">Descargar Archivo</a>
                    }
                    else
                    {
                        <div> <em> No Subido </em> </div>
                    }
                </div>
            </div>
            <hr />
            <div class="form-group">
                <div class="ui-sortable">
                    <button type="submit" class="btn btn-sm btn-primary m-r-10 pull-right"><i class="fa fa-save"></i>&nbsp;&nbsp;Guardar</button>
                    <a href="@Url.Action("LstUsuarioAdm", "User")" class="btn btn-sm btn-default m-r-5 pull-right"><i class="fa fa-arrow-left"></i>&nbsp;&nbsp;Cancelar</a>
                </div>
            </div>

        </form>
    </div>
</div>
