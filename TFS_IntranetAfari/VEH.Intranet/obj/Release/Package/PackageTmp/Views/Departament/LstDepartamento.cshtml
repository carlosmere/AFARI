@model VEH.Intranet.ViewModel.Departament.LstDepartamentoViewModel

@{
    ViewBag.Title = "Adm. Departamento";
    var IndiceCantidadReporte = Model.CantidadReporte;
}

@section Breadcrumbs{
    <li><a href="@Url.Action("LstEdificio", "Building")">Lista de Edificios</a></li>
    <li><a href="@Url.Action("LstOpcionEdificio", "Building", new { EdificioId = Model.EdificioId })">Opciones Edificio</a></li>
}

<div class="row">
    <div class="col-sm-12">
        <div class="panel panel-inverse">
            <div class="panel-body">
                <h4><i class="fa fa-building-o"></i>&nbsp;Edificio</h4>
                <dl class="dl-horizontal">
                    <dt>Nombre</dt>
                    <dd>@Model.NombreEdificio</dd>
                </dl>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12">
        <div class="pull-right">
            <a class="btn btn-success" href="@Url.Action("DownloadRelacionPropietario", "Departament", new { EdificioId = Model.EdificioId})"><i class="fa fa-download"></i> Descargar Relación de Propietarios</a>
        </div>
    </div>
</div><br />
<div>
    <div>
        <div class="panel panel-inverse">
            <div class="panel-heading">
                <h4 class="panel-title"><i class="fa fa-list"></i>&nbsp;&nbsp;Listado</h4>
            </div>
            <div class="panel-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th class="col-sm-2 text-center">Número</th>
                                <th class="col-sm-2 text-center">Propietario</th>
                                <th class="col-sm-2 text-center">Celular</th>
                                <th class="col-sm-2 text-center">Email</th>

                                @*<th class="col-sm-2 text-center">Piso</th>
                                    <th class="col-sm-2 text-center">Lectura de agua</th>*@
                                <th class="col-sm-1 text-center">Estado</th>
                                @*<th class="col-sm-1 text-center">Num. Recibo</th>*@
                                <th class="col-sm-2 text-center">Opciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model.LstDepartamentos)
                            {
                                var Propietario = ConstantHelpers.getTitularDepartamento(item);


                                <tr>
                                    <td class="text-center">@(item.TipoInmueble != null ? item.TipoInmueble.Acronimo : String.Empty) @item.Numero</td>

                                    @if (Propietario == null)
                                    {
                                        <td class="text-center"> N/N</td>
                                        <td class="text-center">-</td>
                                        <td class="text-center">-</td>
                                    }
                                    else
                                    {

                                        var Inquilino = Propietario.Inquilino.FirstOrDefault();

                                        <td class="text-center">
                                            @Propietario.Nombres

                                            @if (Inquilino != null)
                                            {
                                                @Html.Raw("/(Inq : " + Inquilino.Nombres + ")");
                                            }
                                        </td>

                                        <td class="text-center">@Propietario.Celular</td>
                                        <td class="text-center">@Propietario.Email</td>
                                    }
                                    @*<td class="text-center">@item.Piso</td>
                                        <td class="text-center">@String.Format("{0:0,0.00}", item.LecturaAgua)</td>*@
                                    <td class="text-center">
                                        <span class="label @(item.Estado == ConstantHelpers.EstadoActivo ? "label-success" : "label-danger")">
                                            @(item.Estado == ConstantHelpers.EstadoActivo ? "Activo" : "Inactivo")
                                        </span>
                                    </td>
                                    @*<td>
                                        <label>@(Model.Identificador.ToString().PadLeft(3, '0') + "-" + Model.DicNumeroRecibo[item.DepartamentoId])</label>
                                        @{ IndiceCantidadReporte++;}
                                    </td>*@
                                    <td class="text-center">
                                        <div class="input-group">
                                            <div class="input-group-btn btn-xs">
                                                <a href="@Url.Action("AddEditDepartamento", "Departament", new { DepartamentoId = item.DepartamentoId, EdificioId = Model.EdificioId })" class="btn btn-default btn-xs"><i class="fa fa-pencil"></i>&nbsp;Editar</a>
                                                <button type="button" class="btn btn-default dropdown-toggle btn-xs" data-toggle="dropdown">
                                                    <span class="caret"></span>
                                                </button>
                                                <ul class="dropdown-menu">
                                                    <li><a href="@Url.Action("LstPropietario", "Owner", new { DepartamentoId = item.DepartamentoId, EdificioId = Model.EdificioId })"><i class="fa fa-key"></i>&nbsp;&nbsp;Adm. Propietarios</a></li>
                                                    <li><a href="@Url.Action("LstUsuario", "User", new { DepartamentoId = item.DepartamentoId, EdificioId = Model.EdificioId })"><i class="fa fa-user"></i>&nbsp;&nbsp;Adm. Usuarios</a></li>
                                                    <li><a href="@Url.Action("ViewDepartamento", "Departament", new { DepartamentoId = item.DepartamentoId, EdificioId = Model.EdificioId })"><i class="fa fa-eye"></i>&nbsp;&nbsp;Ver</a></li>
                                                    <li class="divider"></li>
                                                    <li><a @Data.ModalLink("_ActDeactDepartamento", "Departament", new { DepartamentoId = item.DepartamentoId, Estado = item.Estado, EdificioId = Model.EdificioId })><i class="fa fa-eye@(item.Estado == ConstantHelpers.EstadoActivo ? "-slash" : "")"></i>&nbsp;&nbsp;@(item.Estado == ConstantHelpers.EstadoActivo ? "Desactivar" : "Activar")</a></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                    @*@Html.PagedListPager(Model.LstDepartamentos, page => Url.Action("LstDepartamento", new { np = page , EdificioId = Model.EdificioId }), ConstantHelpers.Bootstrap3Pager)*@
                </div>
            </div>
        </div>
    </div>
</div>
<a class="btn btn-sm btn-default" href="@Url.Action("LstEdificio", "Building")"><i class="fa fa-arrow-left"></i>&nbsp;Regresar</a>&nbsp;&nbsp;
<a class="btn btn-sm btn-primary" href="@Url.Action("AddEditDepartamento", "Departament", new { EdificioId = Model.EdificioId })"><i class="fa fa-plus"></i>&nbsp;Agregar departamento</a>
