@model VEH.Intranet.ViewModel.User.AddEditUsuarioViewModel

@{
    ViewBag.Title = (Model.UsuarioId != null ? "Editar" : "Agregar") + " usuario";
}

@section Breadcrumbs{
    <li><a href="@Url.Action("LstEdificio", "Building")">Edificio</a></li>
    <li><a href="@Url.Action("LstDepartamento", "Departament", new { EdificioId = Model.Edificio.EdificioId })">Departamento</a></li>
    <li><a href="@Url.Action("LstUsuario", "User", new { DepartamentoId = Model.Departamento.DepartamentoId, EdificioId = Model.Edificio.EdificioId })">Usuario</a></li>
}

@section Styles{
    @RazorHelpers.Content("plugins/password-indicator/css/password-indicator.css", Url)
}

@section Scripts{
    @RazorHelpers.Content("plugins/password-indicator/js/password-indicator.js", Url)
    
    <script type="text/javascript">
        $(document).ready(function () {
            
            var handleFormPasswordIndicator = function () {
                "use strict";
                $("#password-indicator-visible").passwordStrength({ targetDiv: "#passwordStrengthDiv2" })
            };
            var FormPlugins = function () { "use strict"; return { init: function () { handleFormPasswordIndicator(); } } }()
            FormPlugins.init();

            $("#Codigo").change(function (e) {
                e.preventDefault()
                $.ajax({
                    cache: false,
                    type: "GET",
                    url: "@Url.Action("VerificarCodigoUsuario")",
                    data: { "codigo": this.value },
                    success: function (data) {
                        $("#spUsuarioExiste").empty().html("")
                        if (!data) { $("#spUsuarioExiste").html('<i class="fa fa-times"></i> <span style="color:#e5603b"> El código de usuario ya existe</span>') }
                        else { $("#spUsuarioExiste").html('<i class="fa fa-check"></i> <span style="color:#7cdda7"> El código de usuario esta disponible</span>') }
                    }
                })
             })
        })
    </script>
}
<div class="row">
    <div class="col-sm-12">
        <div class="panel panel-inverse">
            <div class="panel-body">
                <h4><i class="fa fa-building-o"></i>&nbsp;Edificio</h4>
                <dl class="dl-horizontal">
                    <dt>Nombre</dt>
				    <dd>@Model.Edificio.Nombre</dd>
			    </dl>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-sm-12">
        <div class="panel panel-inverse">
            <div class="panel-body">
                <h4><i class="fa fa-desktop"></i>&nbsp;Departamento</h4>
                <dl class="dl-horizontal">
				    <dt>Piso</dt>
				    <dd>@Model.Departamento.Piso</dd>
                    <dt>Número</dt>
				    <dd>@Model.Departamento.Numero</dd>
			    </dl>
            </div>
        </div>
    </div>
</div>

<div class="panel panel-inverse">
    <div class="panel-body">
        <form method="post" class="form-horizontal">
            @Html.HiddenFor(x => x.UsuarioId)
            @Html.HiddenFor(x => x.EdificioId)
            @Html.HiddenFor(x => x.DepartamentoId)

             <div class="form-group">
                <label class="col-md-2 control-label">Usuario</label>
                <div class="col-md-3">
                    @Html.TextBoxFor(x => x.Codigo, new { @class = "form-control " }) 
                    <span id="spUsuarioExiste"> </span>     
                    @Html.ValidationMessageFor(x => x.Codigo)
                </div>
            </div>
            @Html.EditorFor(x => x.Nombres)
             <div class="form-group">
                <label class="col-md-2 control-label">Contraseña</label>
                <div class="col-md-4">
                    @Html.TextBoxFor(x => x.Password, new { @class = "form-control  m-b-5", name = "password-visible", id = "password-indicator-visible" })                    
                    <div id="passwordStrengthDiv2" class="is0 m-t-5"></div>
                    @Html.ValidationMessageFor(x => x.Password)
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">Email</label>
                <div class="col-md-3">
                    @Html.TextBoxFor(x => x.Email, new { @class = "form-control " })
                    
                    @Html.ValidationMessageFor(x => x.Email)
                </div>
            </div>
            <div class="form-group">
                <label class="col-md-2 control-label">Estado</label>
                <div class="col-md-3">

                    <select name="Estado" class="form-control">
                        <option selected value="ACT" style="background-color:lightgreen">Activo</option>
                        <option value="INA" style="background-color:lightgrey">Inactivo</option>
                    </select>
                </div>
            </div>
            <hr />
            <div class="form-group">
                <div class="ui-sortable">
                    <button type="submit" class="btn btn-sm btn-primary m-r-10 pull-right"><i class="fa fa-save"></i>&nbsp;&nbsp;Guardar</button>
                    <a href="@Url.Action("LstUsuario", "User", new { DepartamentoId = Model.DepartamentoId, EdificioId = Model.EdificioId })" class="btn btn-sm btn-default m-r-5 pull-right"><i class="fa fa-arrow-left"></i>&nbsp;&nbsp;Cancelar</a>
                </div>
            </div>
        </form>
    </div>
</div>
